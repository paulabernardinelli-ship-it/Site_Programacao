<!doctype html>
<html lang='pt-BR'>
<head>
  <meta charset='utf-8'>
  <meta name='viewport' content='width=device-width,initial-scale=1'>
  <title>Cadastro ‚Äî Selene</title>
  <link href='https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600&family=Nunito:wght@300;400;700&display=swap' rel='stylesheet'>
  <link rel='stylesheet' href='style.css'>
</head>
<body>
  <!-- Menu fixo em todas as p√°ginas -->
  <nav class="fixed-nav">
    <div class="nav-container">
      <div class='logo'><h1>A Gata Selene</h1></div>
      <ul>
        <li><a href='index.html'>In√≠cio</a></li>
        <li><a href='cadastro.html'>Cadastro</a></li>
        <li><a href='produtos.html'>Prefer√™ncias</a></li>
        <li><a href='contato.html'>Contato</a></li>
        <li><a href='sobre.html'>Sobre</a></li>
      </ul>
    </div>
  </nav>

  <div class='container'>
    <header>
      <div class='logo'><h1>A Gata Selene</h1></div>
    </header>
    <main>
      <div class='pref-card'>
        <h2>Cadastro</h2>
        <p style='color:var(--muted); margin-bottom: 24px;'>Complete seu cadastro para receber recomenda√ß√µes personalizadas da Selene.</p>
        
        <form id='form-cadastro'>
          <div class='form-grid'>
            <!-- Dados Pessoais -->
            <div class='form-group'>
              <label for='nome'>Nome completo *</label>
              <input id='nome' type='text' required>
            </div>
            
            <div class='form-group'>
              <label for='idade'>Idade *</label>
              <input id='idade' type='number' min='12' max='120' required>
            </div>
            
            <div class='form-group'>
              <label for='email'>E-mail *</label>
              <input id='email' type='email' required>
            </div>
            
            <div class='form-group'>
              <label for='telefone'>Telefone</label>
              <input id='telefone' type='tel' placeholder='(11) 99999-9999'>
            </div>
            
            <!-- Separador -->
            <div class='form-group' style='grid-column:1 / -1'>
              <hr style='border: none; border-top: 2px solid rgba(90,30,166,0.1); margin: 20px 0;'>
              <h3 style='color: var(--accent); font-family: "Cormorant Garamond", serif; margin-bottom: 16px;'>Endere√ßo</h3>
            </div>
            
            <!-- Busca por CEP -->
            <div class='form-group'>
              <label for='cep'>CEP *</label>
              <div class="cep-container">
                <input id='cep' type='text' maxlength='9' placeholder='00000-000' required>
                <button type="button" id="buscar-cep" class="cep-button">Buscar CEP</button>
              </div>
              <small style='color:var(--muted); font-size: 0.85rem;'>Digite o CEP e clique em Buscar para preencher automaticamente</small>
            </div>
            
            <div class='form-group'>
              <label for='logradouro'>Logradouro *</label>
              <input id='logradouro' type='text' required>
            </div>
            
            <div class='form-group'>
              <label for='numero'>N√∫mero *</label>
              <input id='numero' type='text' required>
            </div>
            
            <div class='form-group'>
              <label for='complemento'>Complemento</label>
              <input id='complemento' type='text' placeholder='Apto, Bloco, Casa...'>
            </div>
            
            <div class='form-group'>
              <label for='bairro'>Bairro *</label>
              <input id='bairro' type='text' required>
            </div>
            
            <div class='form-group'>
              <label for='cidade'>Cidade *</label>
              <input id='cidade' type='text' required>
            </div>
            
            <div class='form-group'>
              <label for='estado'>Estado *</label>
              <input id='estado' type='text' required readonly style='background-color: rgba(90,30,166,0.05);'>
            </div>
            
            <!-- Prefer√™ncias Liter√°rias -->
            <div class='form-group' style='grid-column:1 / -1'>
              <hr style='border: none; border-top: 2px solid rgba(90,30,166,0.1); margin: 20px 0;'>
              <h3 style='color: var(--accent); font-family: "Cormorant Garamond", serif; margin-bottom: 16px;'>Prefer√™ncias Liter√°rias</h3>
            </div>
            
            <div class='form-group' style='grid-column:1 / -1'>
              <label for='genero-favorito'>G√™nero liter√°rio favorito</label>
              <select id='genero-favorito'>
                <option value=''>Selecione seu g√™nero preferido</option>
                <option value='romance'>Romance</option>
                <option value='fantasia'>Fantasia</option>
                <option value='ficcao'>Fic√ß√£o Cient√≠fica</option>
                <option value='misterio'>Mist√©rio</option>
                <option value='suspense'>Suspense</option>
                <option value='biografia'>Biografia</option>
                <option value='autoajuda'>Autoajuda</option>
                <option value='thriller'>Thriller</option>
                <option value='young adult'>Young Adult</option>
                <option value='distopia'>Distopia</option>
              </select>
            </div>
            
            <div class='form-group' style='grid-column:1 / -1'>
              <label for='autor-favorito'>Autor favorito</label>
              <input id='autor-favorito' type='text' placeholder='Quem √© seu autor favorito?'>
            </div>
          </div>
          
          <div class='btn-center'>
            <button type='submit' class='primary'>Salvar informa√ß√µes</button>
          </div>
        </form>
      </div>
    </main>
    <footer>
      <p>¬© 2025 A Gata Selene Indica Livro</p>
    </footer>
  </div>

  <script>
    // Script espec√≠fico para a p√°gina de cadastro com ViaCEP
    document.addEventListener('DOMContentLoaded', function() {
      const formCadastro = document.getElementById('form-cadastro');
      const cepInput = document.getElementById('cep');
      const buscarCepBtn = document.getElementById('buscar-cep');
      
      // M√°scara para o CEP
      cepInput.addEventListener('input', function(e) {
        let value = e.target.value.replace(/\D/g, '');
        if (value.length > 5) {
          value = value.substring(0, 5) + '-' + value.substring(5, 8);
        }
        e.target.value = value;
      });
      
      // Buscar endere√ßo por CEP usando ViaCEP
      buscarCepBtn.addEventListener('click', buscarEnderecoPorCEP);
      cepInput.addEventListener('blur', function() {
        if (this.value.length === 9) {
          buscarEnderecoPorCEP();
        }
      });
      
      async function buscarEnderecoPorCEP() {
        const cep = cepInput.value.replace(/\D/g, '');
        
        if (cep.length !== 8) {
          showAlert('CEP inv√°lido. Digite um CEP com 8 d√≠gitos.');
          return;
        }
        
        // Mostrar loading
        buscarCepBtn.innerHTML = '<span class="loading-spinner"></span> Buscando...';
        buscarCepBtn.disabled = true;
        buscarCepBtn.classList.add('loading');
        
        try {
          // Usando ViaCEP - API gratuita e confi√°vel
          const response = await fetch(`https://viacep.com.br/ws/${cep}/json/`);
          
          if (!response.ok) {
            throw new Error('Erro na rede');
          }
          
          const data = await response.json();
          
          if (data.erro) {
            showAlert('CEP n√£o encontrado. Verifique o n√∫mero digitado.');
            return;
          }
          
          // Preencher os campos com os dados retornados pelo ViaCEP
          document.getElementById('logradouro').value = data.logradouro || '';
          document.getElementById('bairro').value = data.bairro || '';
          document.getElementById('cidade').value = data.localidade || '';
          document.getElementById('estado').value = data.uf || '';
          document.getElementById('complemento').value = data.complemento || '';
          
          // Adicionar classe de feedback visual para campos preenchidos
          const camposPreenchidos = ['logradouro', 'bairro', 'cidade', 'estado'];
          camposPreenchidos.forEach(campo => {
            const element = document.getElementById(campo);
            element.classList.add('auto-filled');
            setTimeout(() => element.classList.remove('auto-filled'), 2000);
          });
          
          // Focar no campo n√∫mero ap√≥s preencher o endere√ßo
          document.getElementById('numero').focus();
          
          showAlert('Endere√ßo encontrado com sucesso! Agora preencha o n√∫mero.');
          
        } catch (error) {
          console.error('Erro ao buscar CEP:', error);
          showAlert('Erro ao buscar endere√ßo. Verifique sua conex√£o ou tente novamente.');
        } finally {
          // Restaurar bot√£o
          buscarCepBtn.innerHTML = 'Buscar CEP';
          buscarCepBtn.disabled = false;
          buscarCepBtn.classList.remove('loading');
        }
      }
      
      // Valida√ß√£o do formul√°rio de cadastro
      if (formCadastro) {
        formCadastro.addEventListener('submit', function(e) {
          e.preventDefault();
          
          // Coletar dados do formul√°rio
          const nome = document.getElementById('nome').value;
          const email = document.getElementById('email').value;
          const idade = document.getElementById('idade').value;
          const cep = document.getElementById('cep').value;
          const logradouro = document.getElementById('logradouro').value;
          const numero = document.getElementById('numero').value;
          
          // Valida√ß√£o dos campos obrigat√≥rios
          if (!nome || !email || !idade || !cep || !logradouro || !numero) {
            showAlert('Por favor, preencha todos os campos obrigat√≥rios (*).');
            return;
          }
          
          // Valida√ß√£o de email
          const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
          if (!emailRegex.test(email)) {
            showAlert('Por favor, digite um e-mail v√°lido.');
            return;
          }
          
          // Simular envio do formul√°rio com loading
          const submitBtn = this.querySelector('button[type="submit"]');
          const originalText = submitBtn.innerHTML;
          submitBtn.innerHTML = '<span class="loading-spinner"></span> Salvando...';
          submitBtn.disabled = true;
          
          setTimeout(() => {
            showAlert('üéâ Cadastro realizado com sucesso! Bem-vindo √† comunidade Selene.');
            
            // Restaurar bot√£o
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
            
            // Redirecionar para p√°gina de prefer√™ncias ap√≥s 2 segundos
            setTimeout(() => {
              window.location.href = 'produtos.html';
            }, 2000);
          }, 1500);
        });
      }
      
      // Fun√ß√£o para mostrar alertas
      function showAlert(msg) { 
        // Remover alertas anteriores
        const alertasAnteriores = document.querySelectorAll('.alert');
        alertasAnteriores.forEach(alerta => alerta.remove());
        
        const a = document.createElement('div'); 
        a.className = 'alert'; 
        a.textContent = msg; 
        document.body.appendChild(a); 
        setTimeout(() => a.remove(), 4500); 
      }
      
      // Valida√ß√£o de email em tempo real
      const emailInput = document.getElementById('email');
      emailInput.addEventListener('blur', function() {
        const email = this.value;
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        
        if (email && !emailRegex.test(email)) {
          this.style.borderColor = '#e74c3c';
          showAlert('Por favor, digite um e-mail v√°lido.');
        } else if (email) {
          this.style.borderColor = '#27ae60';
        } else {
          this.style.borderColor = '';
        }
      });
      
      // Valida√ß√£o de idade
      const idadeInput = document.getElementById('idade');
      idadeInput.addEventListener('blur', function() {
        const idade = parseInt(this.value);
        if (idade < 12 || idade > 120) {
          this.style.borderColor = '#e74c3c';
          showAlert('A idade deve ser entre 12 e 120 anos.');
        } else if (this.value) {
          this.style.borderColor = '#27ae60';
        } else {
          this.style.borderColor = '';
        }
      });
    });
  </script>
</body>
</html>